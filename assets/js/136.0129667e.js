(window.webpackJsonp=window.webpackJsonp||[]).push([[136],{616:function(n,t,a){"use strict";a.r(t);var i=a(4),e=Object(i.a)({},(function(){var n=this,t=n.$createElement,a=n._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[a("h1",{attrs:{id:"函数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#函数"}},[n._v("#")]),n._v(" 函数")]),n._v(" "),a("p",[n._v("排除"),a("RouterLink",{attrs:{to:"/scope/lifetime/elision.html"}},[n._v("省略")]),n._v("（elision）的情况，带上生命周期的函数签名有一些限制：")],1),n._v(" "),a("ul",[a("li",[n._v("任何引用"),a("strong",[n._v("都必须")]),n._v("拥有标注好的生命周期。")]),n._v(" "),a("li",[n._v("任何被返回的引用"),a("strong",[n._v("都必须")]),n._v("有和某个输入量相同的生命周期或是静态类型（"),a("code",[n._v("static")]),n._v("）。")])]),n._v(" "),a("p",[n._v("另外要注意，如果没有输入的函数返回引用，有时会导致返回的引用指向无效数据，这种\n情况下禁止它返回这样的引用。下面例子展示了一些合法的带有生命周期的函数：")]),n._v(" "),a("div",{staticClass:"language-rust,editable extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("// 一个拥有生命周期 `'a` 的输入引用，其中 `'a` 的存活时间\n// 至少与函数的一样长。\nfn print_one<'a>(x: &'a i32) {\n    println!(\"`print_one`: x is {}\", x);\n}\n\n// 可变引用同样也可能拥有生命周期。\nfn add_one<'a>(x: &'a mut i32) {\n    *x += 1;\n}\n\n// 拥有不同生命周期的多个元素。对下面这种情形，两者即使拥有\n// 相同的生命周期 `'a` 也没问题，但对一些更复杂的情形，可能\n// 就需要不同的生命周期了。\nfn print_multi<'a, 'b>(x: &'a i32, y: &'b i32) {\n    println!(\"`print_multi`: x is {}, y is {}\", x, y);\n}\n\n// 返回传递进来的引用也是可行的。\n// 但必须返回正确的生命周期。\nfn pass_x<'a, 'b>(x: &'a i32, _: &'b i32) -> &'a i32 { x }\n\n//fn invalid_output<'a>() -> &'a String { &String::from(\"foo\") }\n// 上面代码是无效的：`'a` 存活的时间必须比函数的长。\n// 这里的 `&String::from(\"foo\")` 将会创建一个 `String` 类型，然后对它取引用。\n// 数据在离开作用域时删掉，返回一个指向无效数据的引用。\n\nfn main() {\n    let x = 7;\n    let y = 9;\n    \n    print_one(&x);\n    print_multi(&x, &y);\n    \n    let z = pass_x(&x, &y);\n    print_one(z);\n\n    let mut t = 3;\n    add_one(&mut t);\n    print_one(&t);\n}\n")])])]),a("h3",{attrs:{id:"参见："}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参见："}},[n._v("#")]),n._v(" 参见：")]),n._v(" "),a("p",[a("RouterLink",{attrs:{to:"/scope/lifetime/fn.html"}},[n._v("函数")])],1)])}),[],!1,null,null,null);t.default=e.exports}}]);